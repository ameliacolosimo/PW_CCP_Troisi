import os
import pymysql
import sqlite3 as spl
import datetime
import pymysql.cursors

conn = pymysql.connect(host='localhost',
                           user='root',
                           password='',
                           db='acme_energia',
                           charset='utf8mb4',
                           cursorclass=pymysql.cursors.DictCursor)

c = conn.cursor()

def add_lettura_consumi(lista):
    conn = pymysql.connect(host='localhost',
                           user='root',
                           password='',
                           db='ACME_Energia',
                           charset='utf8mb4',
                           cursorclass=pymysql.cursors.DictCursor)
    c = conn.cursor()
    c.executemany("INSERT INTO lettura_consumi VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)", (lista))
    conn.commit()


lettura_consumi_t = [
   ('1', '1', '1', 'basso', '1092', '2345', '1253', '2020-5-10', '2020-7-7'),
   ('2', '2', '2', 'alto', '2345', '3456', '1111', '2020-1-1', '2020-2-28'),
   ('3', '3', '3', 'alto', '23445', '43585', '20140', '020-3-25', '2020-5-2'),
   ('4', '4', '4', 'basso', '100', '234', '134', '2020-7-18', '2020-9-1'),
   ('5', '5', '5', 'basso', '56789', '65345', '8556', '2020-9-10', '2020-10-30'),
   ('6', '6', '6', 'basso', '123', '232', '109', '2020-3-10', '2020-5-1'),
   ('7', '7', '7', 'alto', '12113', '64625', '52512', '2020-3-4', '2020-4-30'),
   ('8', '8', '8', 'alto', '1224', '36326', '35102', '2020-7-1', '2020-8-15'),
   ('9', '9', '9', 'basso', '235', '352', '117', '2020-9-4', '2020-10-27'),
   ('10', '10', '10', 'alto', '45778', '59323', '13745', '2020-3-20', '2020-5-2'),
   ('11', '11', '11', 'basso', '12345', '32554', '20209', '2020-1-1', '2020-2-28'),
   ('12', '12', '12', 'basso', '234', '345', '111', '2020-1-15', '2020-3-1'),
   ('13', '13', '13', 'alto', '345', '546', '201', '2020-3-11', '2020-5-5'),
   ('14', '14', '14', 'basso', '34567', '56734', '22167', '2020-7-5', '2020-9-1'),
   ('15', '15', '15', 'alto', '345', '435', '90', '2020-7-15', '2020-9-4'),
   ('16', '16', '2', 'basso', '234', '387', '153', '2020-3-10', '2020-5-1'),
   ('17', '17', '4', 'alto', '123', '345', '222', '2020-3-4', '2020-4-30'),
   ('18', '18', '6', 'alto', '345', '654', '309', '2020-3-20', '2020-5-2'),
   ('19', '19', '8', 'alto', '45673', '67654', '21981', '2020-1-1', '2020-2-28'),
   ('20', '20', '14', 'basso', '34523', '56784', '22261', '2020-7-18', '2020-9-1'),
   ]

add_lettura_consumi(lettura_consumi_t)
